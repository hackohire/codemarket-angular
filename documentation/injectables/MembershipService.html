<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>codemarket documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">codemarket documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content injectable">
                   <div class="content-data">







<ol class="breadcrumb">
  <li>Injectables</li>
  <li>MembershipService</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/membership/membership.service.ts</code>
        </p>




            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#acceptInvitation">acceptInvitation</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#attachCardAndCreateSubscription">attachCardAndCreateSubscription</a>
                            </li>
                            <li>
                                <a href="#cancelSubscription">cancelSubscription</a>
                            </li>
                            <li>
                                <a href="#createStripeUser">createStripeUser</a>
                            </li>
                            <li>
                                <a href="#getCouponByName">getCouponByName</a>
                            </li>
                            <li>
                                <a href="#getMembershipSubscriptionsByUserId">getMembershipSubscriptionsByUserId</a>
                            </li>
                            <li>
                                <a href="#inviteMembersToSubscription">inviteMembersToSubscription</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>

            <section>
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor(httpClient: <a href="https://angular.io/api/common/http/HttpClient" target="_blank">HttpClient</a>, apollo: Apollo, sweetAlertService: <a href="../injectables/SweetalertService.html">SweetalertService</a>, authService: <a href="../injectables/AuthService.html">AuthService</a>)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="14" class="link-to-prism">src/app/membership/membership.service.ts:14</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>httpClient</td>
                                                  
                                                        <td>
                                                                        <code><a href="https://angular.io/api/common/http/HttpClient" target="_blank" >HttpClient</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>apollo</td>
                                                  
                                                        <td>
                                                                    <code>Apollo</code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>sweetAlertService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/SweetalertService.html" target="_self" >SweetalertService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>authService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/AuthService.html" target="_self" >AuthService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section>
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="acceptInvitation"></a>
                    <span class="name">
                        <b>
                            acceptInvitation
                        </b>
                        <a href="#acceptInvitation"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>acceptInvitation(subscriptionId, email)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="338"
                            class="link-to-prism">src/app/membership/membership.service.ts:338</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>subscriptionId</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>email</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="attachCardAndCreateSubscription"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Async</span>
                            attachCardAndCreateSubscription
                        </b>
                        <a href="#attachCardAndCreateSubscription"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>attachCardAndCreateSubscription(source, stripeId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, trial_period_days: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>, metadata, items, coupon: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="240"
                            class="link-to-prism">src/app/membership/membership.service.ts:240</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>source</td>
                                    <td>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>stripeId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>trial_period_days</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>metadata</td>
                                    <td>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>items</td>
                                    <td>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>coupon</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>{}</code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="cancelSubscription"></a>
                    <span class="name">
                        <b>
                            cancelSubscription
                        </b>
                        <a href="#cancelSubscription"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>cancelSubscription(subscriptionId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="365"
                            class="link-to-prism">src/app/membership/membership.service.ts:365</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>subscriptionId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="createStripeUser"></a>
                    <span class="name">
                        <b>
                            createStripeUser
                        </b>
                        <a href="#createStripeUser"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>createStripeUser()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="213"
                            class="link-to-prism">src/app/membership/membership.service.ts:213</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>FOR INTERNAL USE ONLY </p>
</div>

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getCouponByName"></a>
                    <span class="name">
                        <b>
                            getCouponByName
                        </b>
                        <a href="#getCouponByName"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>getCouponByName(couponCode: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="229"
                            class="link-to-prism">src/app/membership/membership.service.ts:229</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Apply Coupon Code </p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>couponCode</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getMembershipSubscriptionsByUserId"></a>
                    <span class="name">
                        <b>
                            getMembershipSubscriptionsByUserId
                        </b>
                        <a href="#getMembershipSubscriptionsByUserId"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>getMembershipSubscriptionsByUserId()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="257"
                            class="link-to-prism">src/app/membership/membership.service.ts:257</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="inviteMembersToSubscription"></a>
                    <span class="name">
                        <b>
                            inviteMembersToSubscription
                        </b>
                        <a href="#inviteMembersToSubscription"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>inviteMembersToSubscription(subscriptionId, users)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="298"
                            class="link-to-prism">src/app/membership/membership.service.ts:298</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>subscriptionId</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>users</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>

    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Injectable } from &#x27;@angular/core&#x27;;
import { HttpClient } from &#x27;@angular/common/http&#x27;;
import { environment } from &#x27;src/environments/environment&#x27;;
import { map } from &#x27;rxjs/operators&#x27;;
import { Apollo } from &#x27;apollo-angular&#x27;;
import gql from &#x27;graphql-tag&#x27;;
import { SweetalertService } from &#x27;../shared/services/sweetalert.service&#x27;;
import { AuthService } from &#x27;../core/services/auth.service&#x27;;
// declare var paypal;

@Injectable({
  providedIn: &#x27;root&#x27;
})
export class MembershipService {

  // paypalConfig;

  constructor(
    private httpClient: HttpClient,
    private apollo: Apollo,
    private sweetAlertService: SweetalertService,
    private authService: AuthService,
  ) { }


  /** FOR INTERNAL USE ONLY */
  /** Generate &quot;access_token&quot; by authenticating with paypal using @clientId &amp; @secret */
  /** @see https://developer.paypal.com/docs/api/get-an-access-token-postman/ */

  // generatePaypalOauth2Token() {
  //   this.paypalConfig &#x3D; JSON.parse(this.getPaypalConfig());
  //   if (!this.paypalConfig) {

  //     const urlSearchParams &#x3D; new URLSearchParams();
  //     urlSearchParams.set(&#x27;grant_type&#x27;, &#x27;client_credentials&#x27;);
  //     const body &#x3D; urlSearchParams.toString();

  //     const httpOptions &#x3D; {
  //       headers: new HttpHeaders({
  //         &#x27;Content-Type&#x27;: &#x27;application/x-www-form-urlencoded&#x27;,
  //         Authorization: &#x27;Basic &#x27; + btoa(&#x60;${environment.paypalClientId}:${environment.paypalSecret}&#x60;)
  //       })
  //     };

  //     this.httpClient.post(&#x60;${environment.paypalSandbox}/v1/oauth2/token&#x60;, body, httpOptions)
  //       .pipe(
  //         retry(1)
  //       )
  //       .subscribe((res) &#x3D;&gt; {
  //         this.paypalConfig &#x3D; res;
  //         localStorage.setItem(&#x27;paypalConfig&#x27;, JSON.stringify(res));
  //       });
  //   }
  // }


  /** FOR INTERNAL USE ONLY */
  /** Create Product on Paypal Subcription */
  /** @see https://developer.paypal.com/docs/subscriptions/integrate/#2-create-a-product */

  // createProduct() {
  //   const httpOptions &#x3D; {
  //     headers: new HttpHeaders({
  //       &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,
  //       Authorization: &#x27;Bearer &#x27; + JSON.parse(this.getPaypalConfig()).access_token
  //     })
  //   };

  //   const body &#x3D; {
  //     name: &#x27;Monthly Events For Developers&#x27;,
  //     description: &#x27;Connecting with the developers / tech experts / co-founders&#x27;,
  //     type: &#x27;SERVICE&#x27;,
  //     category: &#x27;Networking&#x27;,
  //     image_url: &#x27;&#x27;,
  //     home_url: &#x27;&#x27;
  //   };

  //   this.httpClient.post(&#x60;${environment.paypalSandbox}/v1/catalogs/products&#x60;, body, httpOptions)
  //     .subscribe((res) &#x3D;&gt; {
  //       console.log(res);
  //     });
  // }

  /** FOR INTERNAL USE ONLY */
  /** Create Plans for the products you have created on Paypal Subcription */
  /** @see https://developer.paypal.com/docs/subscriptions/integrate/#3-create-a-plan */

  // createPlan() {
  //   const httpOptions &#x3D; {
  //     headers: new HttpHeaders({
  //       &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,
  //       Accept: &#x27;application/json&#x27;,
  //       Prefer: &#x27;return&#x3D;representation&#x27;,
  //       Authorization: &#x27;Bearer &#x27; + JSON.parse(this.getPaypalConfig()).access_token
  //     })
  //   };

  //   const plan &#x3D; {
  //     product_id: &#x27;PROD-6XB24663H4094933M&#x27;,
  //     name: &#x27;Ambition Plan&#x27;,
  //     description: &#x27;Ambition plan&#x27;,
  //     billing_cycles: [
  //       {
  //         frequency: {
  //           interval_unit: &#x27;MONTH&#x27;,
  //           interval_count: 1
  //         },
  //         tenure_type: &#x27;TRIAL&#x27;,
  //         sequence: 1,
  //         total_cycles: 1
  //       },
  //       {
  //         frequency: {
  //           interval_unit: &#x27;MONTH&#x27;,
  //           interval_count: 1
  //         },
  //         tenure_type: &#x27;REGULAR&#x27;,
  //         sequence: 2,
  //         total_cycles: 12,
  //         pricing_scheme: {
  //           fixed_price: {
  //             value: &#x27;10&#x27;,
  //             currency_code: &#x27;USD&#x27;
  //           }
  //         }
  //       }
  //     ],
  //     payment_preferences: {
  //       auto_bill_outstanding: true,
  //       setup_fee: {
  //         value: &#x27;10&#x27;,
  //         currency_code: &#x27;USD&#x27;
  //       },
  //       setup_fee_failure_action: &#x27;CONTINUE&#x27;,
  //       payment_failure_threshold: 3
  //     },
  //     taxes: {
  //       percentage: &#x27;10&#x27;,
  //       inclusive: false
  //     }
  //   };

  //   this.httpClient.post(&#x60;${environment.paypalSandbox}/v1/catalogs/products&#x60;, plan, httpOptions)
  //     .subscribe((res) &#x3D;&gt; {
  //       console.log(res);
  //     });
  // }

  /** List the plans of the products you have created on Paypal Subcription */
  /** @see https://developer.paypal.com/docs/subscriptions/full-integration/plan-management/#list-plans */
  // listPlans() {
  //   const httpOptions &#x3D; {
  //     headers: new HttpHeaders({
  //       &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,
  //       Authorization: &#x27;Bearer &#x27; + JSON.parse(this.getPaypalConfig()).access_token
  //     })
  //   };

  //   return this.httpClient.get(&#x60;${environment.paypalSandbox}/v1/billing/plans&#x60;, httpOptions);
  // }


  /** Get the details of the plan */
  /** @see https://developer.paypal.com/docs/subscriptions/full-integration/plan-management/#show-plan-details */
  // getPlanDetails(planId: string) {
  //   const httpOptions &#x3D; {
  //     headers: new HttpHeaders({
  //       &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,
  //       Authorization: &#x27;Bearer &#x27; + JSON.parse(this.getPaypalConfig()).access_token
  //     })
  //   };

  //   return this.httpClient.get(&#x60;${environment.paypalSandbox}/v1/billing/plans/${planId}&#x60;, httpOptions).subscribe({
  //     next: (p) &#x3D;&gt; p
  //   });

  // }

  // getPaypalConfig(): string {
  //   return localStorage.getItem(&#x27;paypalConfig&#x27;);
  // }

  // saveSubscriptionIntoDatabase(subscription) {
  //   return this.apollo.mutate(
  //     {
  //       mutation: gql&#x60;
  //           mutation addMembershipSubscription($subscription: PaypalSubscriptionInput) {
  //             addMembershipSubscription(subscription: $subscription) {
  //               plan_id
  //               purchasedBy {
  //                 name
  //                 avatar
  //                 _id
  //               }
  //               id
  //             }
  //           }
  //         &#x60;,
  //       variables: {
  //         subscription: subscription
  //       }
  //     }
  //   ).pipe(
  //     map((p: any) &#x3D;&gt; {
  //       return p.data.addMembershipSubscription;
  //     })
  //   ).subscribe((sub) &#x3D;&gt; {
  //     console.log(sub);
  //     this.sweetAlertService.success(&#x27;You have successfully subscribed&#x27;, &#x27;&#x27;, &#x27;success&#x27;);
  //   });
  // }

  createStripeUser() {
    return this.httpClient.post(environment.serverless_url + &#x27;createStripeUser&#x27;,
    {
      loggedInUserId: this.authService.loggedInUser._id,
      email: this.authService.loggedInUser.email,
      name: this.authService.loggedInUser.name
    })
    .toPromise().then((d: any) &#x3D;&gt; {
      console.log(d);
      if (d) {
        return d;
      }
    });
  }

  /** Apply Coupon Code */
  getCouponByName(couponCode: string) {
    return this.httpClient.post(environment.serverless_url + &#x27;getCouponByName&#x27;,
    { couponCode })
    .toPromise().then((d: any) &#x3D;&gt; {
      console.log(d);
      if (d) {
        return d;
      }
    });
  }

  async attachCardAndCreateSubscription(source, stripeId: string, trial_period_days: number, metadata, items, coupon: string) {
    const d &#x3D; await this.httpClient.post(environment.serverless_url + &#x27;attachCardAndCreateSubscription&#x27;, {
      loggedInUserId: this.authService.loggedInUser._id,
      items,
      stripeId,
      trial_period_days,
      metadata,
      source,
      name: this.authService.loggedInUser.name,
      coupon
    }).toPromise();
    console.log(d);
    if (d) {
      return d;
    }
  }

  getMembershipSubscriptionsByUserId() {
    return this.apollo.query(
      {
        query: gql&#x60;
          query getMembershipSubscriptionsByUserId($userId: String) {
            getMembershipSubscriptionsByUserId(userId: $userId) {
              plan {
                nickname
                amount
                id
              }
              metadata {
                userId {
                  name
                  _id
                }
              }
              subscriptionUsers {
                name
                email
                invitationAccepted
              }
              quantity
              id
              _id
              status
            }
          }
        &#x60;,
        variables: {
          userId: this.authService.loggedInUser._id,
        },
        fetchPolicy: &#x27;no-cache&#x27;
      },
    ).pipe(
      map((p: any) &#x3D;&gt; {
        return p.data.getMembershipSubscriptionsByUserId;
      }),
    );
  }

  inviteMembersToSubscription(subscriptionId, users) {
    return this.apollo.mutate(
      {
        mutation: gql&#x60;
          mutation inviteMembersToSubscription($subscriptionId: String, $users: [SubscriptionUsersInput]) {
            inviteMembersToSubscription(subscriptionId: $subscriptionId, users: $users) {
              plan {
                nickname
                amount
                id
              }
              metadata {
                userId {
                  name
                  _id
                }
              }
              subscriptionUsers {
                name
                email
                invitationAccepted
              }
              quantity
              id
              _id
            }
          }
        &#x60;,
        variables: {
          subscriptionId,
          users,
        },
      },
    ).pipe(
      map((p: any) &#x3D;&gt; {
        return p.data.inviteMembersToSubscription;
      }),
    );
  }

  acceptInvitation(subscriptionId, email) {
    return this.apollo.mutate(
      {
        mutation: gql&#x60;
          mutation acceptInvitation($subscriptionId: String, $email: String) {
            acceptInvitation(subscriptionId: $subscriptionId, email: $email) {
              subscriptionUsers {
                name
                email
                invitationAccepted
              }
              _id
            }
          }
        &#x60;,
        variables: {
          subscriptionId,
          email,
        },
      },
    ).pipe(
      map((p: any) &#x3D;&gt; {
        return p.data.acceptInvitation;
      }),
    );
  }

  cancelSubscription(subscriptionId: string) {
    return this.apollo.mutate(
      {
        mutation: gql&#x60;
          mutation cancelSubscription($subscriptionId: String) {
            cancelSubscription(subscriptionId: $subscriptionId) {
              plan {
                nickname
                amount
                id
              }
              subscriptionUsers {
                name
                email
                invitationAccepted
              }
              quantity
              id
              _id
            }
          }
        &#x60;,
        variables: {
          subscriptionId,
        },
      },
    ).pipe(
      map((p: any) &#x3D;&gt; {
        return p.data.cancelSubscription;
      }),
    );
  }
}
</code></pre>
    </div>

</div>







                   




                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'injectable';
            var COMPODOC_CURRENT_PAGE_URL = 'MembershipService.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <!-- Required to polyfill modern browsers as code is ES5 for IE... -->
       <script src="../js/libs/custom-elements-es5-adapter.js" charset="utf-8" defer></script>
       <script src="../js/menu-wc.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
